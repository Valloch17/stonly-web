<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Modern browsers -->
    <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">

    <!-- Fallbacks for older browsers / platforms -->
    <link rel="icon" href="/assets/favicon-32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/assets/favicon-192.png" sizes="192x192" type="image/png">
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png" sizes="180x180">


    <title>Stonly Folders UI</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/htm@3.1.1/dist/htm.umd.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <!-- Heading font: Space Grotesk -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/shared.css">
    <style>

        /* Page-level override of shared tokens */
        :root { --bg: #e6e3f8; }

        /* Force Reset button to stay readable in both themes */
        #resetTree {
            background: #ffffff !important;
            /* light chip */
            color: #000000 !important;
            /* black label */
            border-color: var(--border) !important;
        }

        #resetTree:hover {
            filter: brightness(0.97);
        }

        #resetTree:active {
            filter: brightness(0.94);
        }

        /* If the button contains an icon, ensure it follows the text color */
        #resetTree svg {
            fill: currentColor;
        }

        /* Optional: add a subtle shadow to stand out in dark mode */
        html[data-theme="dark"] #resetTree {
            box-shadow: 0 2px 6px rgba(0, 0, 0, .25);
        }

        /* Alternating layer tokens (light & dark) */
        :root {
            /* light: white / very light gray */
            --layer-0: #ffffff;
            --layer-1: #f8fafc;
            /* tailwind slate-50 */
        }

        html[data-theme="dark"] {
            /* dark: two close shades for subtle banding */
            /* Option A: fixed tones */
            --layer-0: #0f172a;
            /*  slate-900-ish card */
            --layer-1: #1e2433;
            /* slate-900 slightly different */

            /* Option B (comment A out, use this instead) — dynamic from your tokens: 
            --layer-0: color-mix(in srgb, var(--card) 92%, var(--bg) 8%);
            --layer-1: color-mix(in srgb, var(--card) 85%, var(--bg) 15%);*/

        }

        /* Utility classes used by the tree nodes */
        .layer-0 { background: var(--layer-0) !important; }
        .layer-1 { background: var(--layer-1) !important; }
    </style>
    <!-- Copy into the head of all HTML pages you wish to display the widget -->

    


</head>

<body class="min-h-screen">
    <div id="app" class="max-w-5xl mx-auto px-4 py-8 space-y-6">
        <div class="flex items-start justify-between gap-3">
            <div>
            <h1 class="text-2xl font-semibold flex items-center gap-2">
                <img src="/assets/Stonly_logotype_master_digital.svg" alt="Stonly" class="h-12 w-auto logo-light">
                <img src="/assets/Stonly_logotype_full_white_digital.svg" alt="Stonly" class="h-12 w-auto logo-dark">
                <span class="title-text">KB Builder</span>
            </h1>
            <p class="text-sm text-slate-500 dark:text-slate-400">
              Create knowledge-base folders from YAML or Tree builder with the Stonly API.
            </p>
          </div>
          <div class="flex items-center gap-3 pt-1">
            <a href="/guide-builder.html"
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 bg-card text-sm font-medium shadow hover:bg-slate-50 transition">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-4 h-4">
                    <circle cx="5" cy="6" r="2"></circle>
                    <circle cx="5" cy="18" r="2"></circle>
                    <circle cx="19" cy="12" r="2"></circle>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M7 6h5a4 4 0 0 1 4 4v0a4 4 0 0 0 4 4"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M7 18h5a4 4 0 0 0 4-4v0a4 4 0 0 1 4-4"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 8v8"></path>
                </svg>
                Guide Builder
            </a>
            <a href="/expert.html"
               class="inline-flex items-center justify-center w-9 h-9 rounded-full border border-slate-200 bg-card text-slate-400 hover:text-slate-600 hover:border-slate-300 transition"
               title="Expert mode" aria-label="Expert mode">
              <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                <path d="M4 9h16l-1.5-4h-13z"></path>
                <path d="M8.5 11a2.5 2.5 0 1 0 0 5h7a2.5 2.5 0 1 0 0-5h-7z"></path>
                <path d="M9 14.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm6 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"></path>
              </svg>
            </a>
            <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" title="Toggle dark mode">
                <span id="themeIcon" aria-hidden="true"></span>
                <span id="themeLabel">Dark</span>
            </button>
          </div>
        </div>
          

        <div class="mb-4 bg-card border rounded-xl shadow-sm p-5 space-y-4">
            <!-- <div class="flex items-center justify-between mb-2">
                <h2 class="text-lg font-semibold">Settings</h2>
            </div> -->

            <!-- Admin token + Stonly API Base URL on one row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 items-end">
                <!-- Admin token -->
                <div>
                    <label class="block text-sm font-medium">
                        Admin token <span class="text-red-600">*</span>
                    </label>
                    <input id="token" type="password" required aria-required="true"
                        class="mt-1 w-full border rounded-lg p-2 text-sm"
                        placeholder="The token can be found on Confluence" />
                </div>

                <!-- Stonly API base URL -->
                <div>
                    <label class="block text-sm font-medium">
                        Stonly API Base URL
                    </label>
                    <input id="st_base" class="mt-1 w-full border rounded-lg p-2 text-sm"
                        placeholder="https://public.stonly.com/api/v3" value="https://public.stonly.com/api/v3" />
                </div>
            </div>




            <!-- Stonly credentials -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-medium">
                        Stonly username <span class="text-red-600">*</span>
                    </label>
                    <input id="st_user" required aria-required="true" class="mt-1 w-full border rounded-lg p-2 text-sm"
                        placeholder="email@company.com" />
                </div>
                <div>
                    <label class="block text-sm font-medium">
                        Stonly token <span class="text-red-600">*</span>
                    </label>
                    <input id="st_pass" type="password" required aria-required="true"
                        class="mt-1 w-full border rounded-lg p-2 text-sm" placeholder="Your Stonly integration token" />
                </div>
            </div>

            <!-- Global creation settings: 4 fields on one row -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-end">
                <div>
                    <label class="block text-sm font-medium">Team ID <span class="text-red-600">*</span></label>
                    <input id="st_team" type="number" required aria-required="true" class="mt-1 w-full border rounded-lg p-2 text-sm" placeholder="e.g. 39539" />
                </div>
                <div>
                    <label class="block text-sm font-medium">Parent Folder ID <span class="text-red-600">*</span></label>
                    <input id="parentId" type="number" required aria-required="true" class="mt-1 w-full border rounded-lg p-2 text-sm" placeholder="e.g. 456234" />
                </div>
                <div>
                    <label class="block text-sm font-medium"><span id="forStonly">Visibility</span></label>
                    <select id="publicAccess" class="mt-1 w-full border rounded-lg p-2 text-sm">
                        <option value="1" selected>Public (1)</option>
                        <option value="0">Private (0)</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium"><span id="forStonly">Language</span></label>
                    <input id="lang" class="mt-1 w-full md:w-24 text-center border rounded-lg p-2 text-sm" value="en" placeholder="en" />
                </div>
            </div>

            <!-- Dry-run on its own row -->
            <div>
                <label class="inline-flex items-center gap-2 text-sm whitespace-nowrap font-medium">
                    <input id="dryRun" type="checkbox" class="h-4 w-4" />
                    Dry-run
                </label>
            </div>

            <!-- YAML (optional) -->
            <div class="flex items-center justify-between">
                <label class="block text-sm font-medium">KB YAML <i>(optional)</i></label>
                <a href="https://gemini.google.com/gem/1EtWRP99BcBjWW09p8DMx_RxtShU06d65?usp=sharing" target="_blank" rel="noopener noreferrer"
                   class="inline-flex items-center gap-2 px-3 py-2 rounded-md border bg-card text-sm font-medium">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4"><path d="M12 2l8 10-8 10L4 12 12 2z"/></svg>
                    KB YAML
                </a>
            </div>
            <textarea id="yaml" class="mt-1 w-full border rounded-lg p-2 text-sm h-36" placeholder="root:
            - name: Support
              description: 'Public info & help center'
              children:
                - name: FAQs
                  description: 'Common questions'
                  children: []
                - name: Tutorials
                  children:
                    - name: Web
                      children: []
                    - name: Mobile
                      description: 'iOS & Android guides'
                      children: []"></textarea>
            <small id="yamlError" class="text-red-600 text-xs"></small>
        </div>



        <div class="mb-4 bg-card border rounded-xl shadow-sm p-5">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-lg font-semibold">Tree Builder</h2>
                <button id="addRoot" class="px-3 py-1 rounded bg-black text-white">+ Root</button>
            </div>
            <div id="tree" class="space-y-2"></div>
        </div>

        <div class="flex gap-2">
            <button id="btnApply" class="px-4 py-2 rounded bg-emerald-600 text-white">Apply</button>
            <button id="btnVerify" class="px-4 py-2 rounded bg-blue-600 text-white">Verify</button>
            <button id="btnDump" class="px-4 py-2 rounded bg-gray-700 text-white">Dump structure</button>
            <button id="resetTree" type="button" class="px-2 py-1 rounded border">Reset tree</button>
            

        </div>

        <div class="bg-card border rounded-xl shadow-sm p-5 mt-4">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-lg font-semibold">Response</h2>
                <button id="copyOut"
                    class="inline-flex items-center gap-2 px-2 py-1 rounded border hover:bg-card active:scale-[0.98]"
                    type="button" aria-label="Copy response" title="Copy response">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                        <path d="M5 15V5a2 2 0 0 1 2-2h10" />
                    </svg>
                    <span class="text-sm">Copy</span>
                </button>
            </div>
            <div class="relative">
                <pre id="out"
                    class="whitespace-pre-wrap text-sm bg-card border rounded p-3 max-h-96 overflow-auto"></pre>
            </div>
        </div>


    </div>
    

    
    <div class="contact-badge">
        <span>Contact:
            <a href="mailto:valentin.bourrelier@stonly.com">valentin.bourrelier@stonly.com</a>
        </span>
        <span class="sep">•</span>
        <a class="gh" href="https://github.com/Valloch17/stonly-web" target="_blank" rel="noopener noreferrer"
            aria-label="Open GitHub repository">
            <!-- GitHub mark (MIT-licensed SVG) -->
            <svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor">
                <path
                    d="M12 .5a11.5 11.5 0 0 0-3.64 22.42c.58.1.79-.25.79-.56v-2c-3.2.7-3.87-1.54-3.87-1.54-.53-1.34-1.28-1.7-1.28-1.7-1.05-.72.08-.7.08-.7 1.16.08 1.77 1.2 1.77 1.2 1.03 1.77 2.7 1.26 3.36.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.28-5.23-5.7 0-1.26.45-2.3 1.2-3.12-.12-.29-.52-1.46.11-3.04 0 0 .98-.31 3.2 1.19a11.1 11.1 0 0 1 5.82 0c2.22-1.5 3.2-1.19 3.2-1.19.63 1.58.23 2.75.11 3.04.75.82 1.2 1.86 1.2 3.12 0 4.43-2.68 5.4-5.24 5.69.41.35.77 1.04.77 2.11v3.13c0 .31.21.67.8.56A11.5 11.5 0 0 0 12 .5z" />
            </svg>
            <span>GitHub</span>
        </a>
    </div>
    


    <script src="/js/shared.js?v=1"></script>
    <script src="/js/kb.js?v=1"></script>
</body>

</html>
